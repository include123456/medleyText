{"_id":"BJDQMcDzG","title":"Ngnx ","body":{"entityMap":{},"blocks":[{"key":"ag6qs","text":"Ngnx ","type":"header-one","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"clulo","text":"Nginx在做反向代理时，提供性能稳定，并且能够提供配置灵活的转发功能。Nginx可以根据不同的正则匹配，采取不同的转发策略，比如图片文件结尾的走文件服务器，动态页面走web服务器，只要你正则写的没问题，又有相对应的服务器解决方案，你就可以随心所欲的玩。并且Nginx对返回结果进行错误页跳转，异常判断等。如果被分发的服务器存在异常，他可以将请求重新转发给另外一台服务器，然后自动去除异常服务器。","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"153bo","text":"","type":"image","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{"src":"http://images2015.cnblogs.com/blog/398358/201602/398358-20160202133724350-1807373891.jpg"}},{"key":"t1q5","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"72lvo","text":"2、负载均衡","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7untr","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"epsek","text":"Nginx提供的负载均衡策略有2种：内置策略和扩展策略。内置策略为轮询，加权轮询，Ip hash。扩展策略，你可以参照所有的负载均衡算法，给他一一找出来做下实现。","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3srrq","text":"","type":"image","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{"src":"http://images2015.cnblogs.com/blog/398358/201602/398358-20160202133753382-1863657242.jpg"}},{"key":"a6rhv","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1mlds","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eag7a","text":"Ip hash算法，对客户端请求的ip进行hash操作，然后根据hash结果将同一个客户端ip的请求分发给同一台服务器进行处理，可以解决session不共享的问题。 ","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2sl00","text":"","type":"image","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{"src":"http://images2015.cnblogs.com/blog/398358/201602/398358-20160201162405944-676557632.jpg"}},{"key":"26ec6","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7eue8","text":"3、web缓存","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3flk2","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ekl7k","text":"Nginx可以对不同的文件做不同的缓存处理，配置灵活，并且支持FastCGI_Cache，主要用于对FastCGI的动态程序进行缓存。配合着第三方的ngx_cache_purge，对制定的URL缓存内容可以的进行增删管理。","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ato1n","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a7huu","text":"nginx config","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1lsgu","text":"1、全局块：配置影响nginx全局的指令。一般有运行nginx服务器的用户组，nginx进程pid存放路径，日志存放路径，配置文件引入，允许生成worker process数等。","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1ta2","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7t8jc","text":"2、events块：配置影响nginx服务器或与用户的网络连接。有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网路连接，开启多个网络连接序列化等。","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fbnbb","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"102h0","text":"3、http块：可以嵌套多个server，配置代理，缓存，日志定义等绝大多数功能和第三方模块的配置。如文件引入，mime-type定义，日志自定义，是否使用sendfile传输文件，连接超时时间，单连接请求数等。","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"csqe2","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cdu38","text":"4、server块：配置虚拟主机的相关参数，一个http中可以有多个server。","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b9pqf","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"aud9n","text":"5、location块：配置请求的路由，以及各种页面的处理情况。","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"136tj","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"59kd9","text":"user  nobody; # Nginx用户及组：用户 组。 user nginx nginx ;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"28h1o","text":"worker_processes  1;#工作进程：数目。根据硬件调整，通常等于CPU数量或者2倍于CPU。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b85to","text":"error_log  logs/error.log; #错误日志：存放路径。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ftppu","text":"#error_log  logs/error.log  notice;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cuq8c","text":"#error_log  logs/error.log  info;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"906sh","text":"pid        logs/nginx.pid; #pid（进程标识符）：存放路径。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8haa5","text":"worker_rlimit_nofile 204800;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9lhu0","text":"#指定进程可以打开的最大描述符：数目。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9m9uc","text":"#这个指令是指当一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（ulimit -n）与nginx进程数相除，但是nginx分配请求并不是那么均匀，所以最好与ulimit -n 的值保持一致。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"f8v12","text":"#现在在linux 2.6内核下开启文件打开数为65535，worker_rlimit_nofile就相应应该填写65535。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"aqi5d","text":"#这是因为nginx调度时分配请求到进程并不是那么的均衡，所以假如填写10240，总并发量达到3-4万时就有进程可能超过10240了，这时会返回502错误。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a52qf","text":"events {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8jsib","text":"    use epoll;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7rrnp","text":"","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ca49b","text":"# 使用epoll的I/O 模型。linux建议epoll，FreeBSD建议采用kqueue，window下不指定。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7dmrm","text":"#补充说明:","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ecvfg","text":"#与apache相类，nginx针对不同的操作系统，有不同的事件模型","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cioi1","text":"#A）标准事件模型","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2uv79","text":"#Select、poll属于标准事件模型，如果当前系统不存在更有效的方法，nginx会选择select或poll","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"853tv","text":"#B）高效事件模型","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"capcb","text":"#Kqueue：使用于FreeBSD 4.1+, OpenBSD 2.9+, NetBSD 2.0 和 MacOS X.使用双处理器的MacOS X系统使用kqueue可能会造成内核崩溃。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cvsd2","text":"#Epoll：使用于Linux内核2.6版本及以后的系统。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9k09l","text":"#/dev/poll：使用于Solaris 7 11/99+，HP/UX 11.22+ (eventport)，IRIX 6.5.15+ 和 Tru64 UNIX 5.1A+。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cja5p","text":"#Eventport：使用于Solaris 10。 为了防止出现内核崩溃的问题， 有必要安装安全补丁。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b0ccr","text":"worker_connections  10240;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"dneiq","text":"#没个工作进程的最大连接数量。根据硬件调整，和前面工作进程配合起来用，尽量大，但是别把cpu跑到100%就行。每个进程允许的最多连接数，理论上每台nginx服务器的最大连接数为。worker_processes*worker_connections","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b0o4l","text":"keepalive_timeout 60;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1eqnb","text":"#keepalive超时时间。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"e1sj3","text":"client_header_buffer_size 4k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1lnjg","text":"","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"drvu3","text":"#客户端请求头部的缓冲区大小。这个可以根据你的系统分页大小来设置，一般一个请求头的大小不会超过1k，不过由于一般系统分页都要大于1k，所以这里设置为分页大小。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1nt54","text":"#分页大小可以用命令getconf PAGESIZE 取得。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"dohg1","text":"#[root@web001 ~]# getconf PAGESIZE  4096","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"33bku","text":"#但也有client_header_buffer_size超过4k的情况，但是client_header_buffer_size该值必须设置为“系统分#页大小”的整倍数。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7h7su","text":"open_file_cache max=65535 inactive=60s;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"pbmo","text":"#这个将为打开文件指定缓存，默认是没有启用的，max指定缓存数量，建议和打开文件数一致，inactive是指经过多长时间文件没被请求后删除缓存。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"e4vh0","text":"open_file_cache_valid 80s;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cb3p5","text":"#这个是指多长时间检查一次缓存的有效信息","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9lali","text":"open_file_cache_min_uses 1;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"flsmp","text":"#open_file_cache指令中的inactive参数时间内文件的最少使用次数，如果超过这个数字，文件描述符一直是在缓存中打开的，如上例，如果有一个文件在inactive时间内一次没被使用，它将被移除。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1b0i9","text":" ","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2dv9h","text":"}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"akfkn","text":"##设定http服务器，利用它的反向代理功能提供负载均衡支持","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"frqa1","text":"http {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"d3fmi","text":"#主模块指令，实现对配置文件所包含的文件的设定，可以减少主配置文件的复杂度，DNS主配置文件中的zonerfc1912,acl基本上都是用include语句。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"68idf","text":"    include       mime.types;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"qnc0","text":"    #核心模块指令，智力默认设置为二进制流，也就是当文件类型未定义时使用这种方式","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b4f5t","text":"    default_type  application/octet-stream;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4irct","text":"    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3mk3s","text":"    #                  '$status $body_bytes_sent \"$http_referer\" '","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8o258","text":"    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8c3l5","text":"    #access_log  logs/access.log  main;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6rcmd","text":"    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2dhgv","text":"    #                  '$status $body_bytes_sent \"$http_referer\" '","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bp7aj","text":"    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c9n3r","text":"   #引用日志main ","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"92sa2","text":"   #access_log  logs/access.log  main;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"doj85","text":"      #设置允许客户端请求的最大的单个文件字节数","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cmskc","text":"      #client_max_body_size 20M;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"16kt6","text":"      #指定来自客户端请求头的headebuffer大小","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"68guu","text":"      #client_header_buffer_size  32k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2a5c7","text":"      #指定连接请求试图写入缓存文件的目录路径","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fitup","text":"      #client_body_temp_path /dev/shm/client_body_temp;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1uplp","text":"      #指定客户端请求中较大的消息头的缓存最大数量和大小，目前设置为4个32KB","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"52nt0","text":"      #large client_header_buffers 4 32k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eljpt","text":"    sendfile        on;#开启高效文件传输模式","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a0m70","text":"    #tcp_nopush     on; 此选项允许或禁止使用socke的TCP_CORK的选项，此选项仅在使用sendfile的时候使用","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"abih2","text":"    #tcp_nodelay    on; 开启防止网络阻塞","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fvtrm","text":"    keepalive_timeout  65; #设置客户端连接保存活动的超时时间","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ckh4f","text":"    #设置客户端请求读取超时时间","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fkfoc","text":"    #client_header_timeout 10;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"733l3","text":"    #设置客户端请求主体读取超时时间","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cis93","text":"    #client_body_timeout 10;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"70ckd","text":"    #send_timeout   用于设置相应客户端的超时时间","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b3tea","text":"    ####HttpGZip模块配置","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"30mas","text":"    #httpGzip modules","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fe18n","text":"    #gzip  on; 开启gzip压缩","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4t2ka","text":"    #gzip_min_length 1k; 设置允许压缩的页面最小字节数","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cks9d","text":"    #gzip_buffers 4 16k;申请4个单位为16K的内存作为压缩结果流缓存","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fugdm","text":"    #gzip_http_version 1.1;#设置识别http协议的版本，默认为1.1","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2mdjj","text":"    #gzip_comp_level 2;指定gzip压缩比，1-9数字越小，压缩比越小，速度越快","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1c265","text":"    #gzip_types text/plain application/x-javascript text/css application/xml;   指定压缩的类型","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"31q7v","text":"    #gzip_vary on; 让前端的缓存服务器进过gzip压缩的页面","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3jem2","text":"    server_names_hash_bucket_size   64; ","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"60vgs","text":"    #保存服务器名字的hash表是由指令server_names_hash_max_size 和server_names_hash_bucket_size所控制的。参数hash bucket size总是等于hash表的大小，并且是一路处理器缓存大小的倍数。在减少了在内存中的存取次数后，使在处理器中加速查找hash表键值成为可能。如果hash bucket size等于一路处理器缓存的大小，那么在查找键的时候，最坏的情况下在内存中查找的次数为2。第一次是确定存储单元的地址，第二次是在存储单元中查找键 值。因此，如果Nginx给出需要增大hash max size 或 hash bucket size的提示，那么首要的是增大前一个参数的大小.","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9cbob","text":"    # Upstream模块是与反向代理，负载均衡相关的模块 ","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3661q","text":"    upstream wd_cluster {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2a9c2","text":"        server 10.152.75.15:8002;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ai6vh","text":"     }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"81j3a","text":"    upstream payment_cluster {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bttc6","text":"         server 10.152.75.15:8003;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5kjlc","text":"     }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b9hda","text":"#  nginx的upstream目前支持4种方式的分配","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"aaem2","text":"#1、轮询（默认）","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"acgc4","text":"#每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3dtf4","text":"#2、weight","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"11rb9","text":"#指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ecojr","text":"#例如：","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bg5qv","text":"upstream bakend {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"32av0","text":"server 192.168.0.14 weight=10;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1omsn","text":"server 192.168.0.15 weight=10;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c62nf","text":"}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"dm525","text":"#2、ip_hash","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"34bfc","text":"#每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，可以解决session的问题。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eert3","text":"#例如：","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fh21k","text":"upstream bakend {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1s02e","text":"ip_hash;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2o3o4","text":"server 192.168.0.14:88;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"e97c1","text":"server 192.168.0.15:80;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5u3ka","text":"}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fpvm0","text":"#3、fair（第三方）","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1668d","text":"#按后端服务器的响应时间来分配请求，响应时间短的优先分配。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7in08","text":"upstream backend {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"kn58","text":"server server1;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cltgf","text":"server server2;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5dce8","text":"fair;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"95qi1","text":"}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3fequ","text":"#4、url_hash（第三方）","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9da1t","text":"#按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存时比较有效。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3tmb5","text":"#例：在upstream中加入hash语句，server语句中不能写入weight等其他的参数，hash_method是使用的hash算法","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3bejs","text":"upstream backend {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9u4r0","text":"server squid1:3128;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1qmtg","text":"server squid2:3128;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"kprk","text":"hash $request_uri;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7qs7o","text":"hash_method crc32;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"893na","text":"}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"78e4e","text":"#tips:#定义负载均衡设备的Ip及设备状态","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2chj7","text":"upstream bakend{","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"f4fbo","text":"ip_hash;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bj280","text":"server 127.0.0.1:9090 down;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"f8dvc","text":"server 127.0.0.1:8080 weight=2;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ea8aq","text":"server 127.0.0.1:6060;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8cqma","text":"server 127.0.0.1:7070 backup;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3btv","text":"}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"emr58","text":"#在需要使用负载均衡的server中增加","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"54dqd","text":"#proxy_pass http://bakend/;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9tk20","text":"#每个设备的状态设置为:","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"26vvk","text":"#1.down表示单前的server暂时不参与负载","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6cuu7","text":"#2.weight为weight越大，负载的权重就越大。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c2qja","text":"#3.max_fails：允许请求失败的次数默认为1.当超过最大次数时，返回proxy_next_upstream模块定义的错误","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4ocic","text":"#4.fail_timeout:max_fails次失败后，暂停的时间。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3qsh3","text":"#5.backup： 其它所有的非backup机器down或者忙的时候，请求backup机器。所以这台机器压力会最轻。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"iku3","text":"#nginx支持同时设置多组的负载均衡，用来给不用的server来使用。","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fu28o","text":"#client_body_in_file_only设置为On 可以讲client post过来的数据记录到文件中用来做debug","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"63egk","text":"#client_body_temp_path设置记录文件的目录 可以设置最多3层目录","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8392e","text":"#location对URL进行匹配.可以进行重定向或者进行新的代理 负载均衡","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c3uc","text":"    server {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"32acp","text":"        listen       10.152.75.15:8001; #监听端口为 10.152.75.15:8001","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"11d2b","text":"        server_name  lm; #设置主机域名","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c7v7f","text":"        #real_ip_header X-Forwarded-For;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"f3tlm","text":"        add_header X-Frame-Options SAMEORIGIN;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"db1et","text":"        #charset koi8-r;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6vh9i","text":"        #access_log  logs/host.access.log  main;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"m312","text":"        location / {   ##代理映射","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7bsdj","text":"            root   /ahsso/applications/lm/html; #设置虚拟主机的网站根目录","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fhoq0","text":"            index  index.html index.htm; # 设置虚拟主机默认访问的网页","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7ot9p","text":"            ssi on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"806j7","text":"        }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8j7gu","text":"      # location ~ ^/mpad/lm/.*\\.(client|wap|jsp|do|web)$ {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4rfj8","text":"      #      proxy_pass   http://wd_cluster;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8dch","text":"      #      proxy_buffer_size 128k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6kc1","text":"      #      proxy_buffers   32 128k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7gqu9","text":"      #      proxy_set_header  X-Real-IP  $remote_addr;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"arkud","text":"      #      client_max_body_size    100m;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cc143","text":"      # }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8qehu","text":"      location /mpad/lm{ #对以“lm”结尾的地址进行负载均衡","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"70not","text":"                ssi on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"55fq6","text":"                proxy_pass  http://wd_cluster/lm; #设置被代理服务器的端口或套接字，以及URL","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3nitq","text":"                proxy_connect_timeout 60s;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fuv3t","text":"                proxy_send_timeout 90;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5sdtu","text":"                proxy_read_timeout 120;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cgbv4","text":"                proxy_buffer_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"am84i","text":"                proxy_buffers 4 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5fqc2","text":"                proxy_busy_buffers_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6puii","text":"                proxy_temp_file_write_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a6kef","text":"                proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6e8qn","text":"                proxy_max_temp_file_size 128m;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1s3e0","text":"                proxy_redirect off;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bmoon","text":"                ","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5l0b9","text":"                proxy_set_header Host $host:$server_port;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6tcug","text":"                proxy_set_header Cache-Control no-cache;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9silh","text":"                proxy_set_header X-Real-IP $remote_addr;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bu3au","text":"                #以上三行，目的是将代理服务器收到的用户的信息传到真实服务器上","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2fiq3","text":"               #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8bv91","text":"               # add_header Set-Cookie \"ahwtapp=ahwtgray; domain=ah.10086.cn ;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6c0f8","text":"                #  path=/; HttpOnly\";","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"404gs","text":"        }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"da4pk","text":"","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fdck9","text":"       location /b2b{","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fjb4c","text":"                ssi on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ec6f8","text":"                proxy_pass  http://wd_cluster/b2b;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3u3pd","text":"                proxy_connect_timeout 60s;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"etulr","text":"                proxy_send_timeout 90;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"foe1v","text":"                proxy_read_timeout 120;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3ir4b","text":"                proxy_buffer_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"599ha","text":"                proxy_buffers 4 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"csn6r","text":"                proxy_busy_buffers_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4s2in","text":"                proxy_temp_file_write_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fc9k0","text":"                proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2cph2","text":"                proxy_max_temp_file_size 128m;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"89tpj","text":"                proxy_redirect off;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"40pjq","text":"                proxy_set_header Host $host:$server_port;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bt5nr","text":"                proxy_set_header Cache-Control no-cache;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"48t01","text":"                proxy_set_header X-Real-IP $remote_addr;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4p88j","text":"               # proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8c3bq","text":"               # add_header Set-Cookie \"ahwtapp=ahwtgray; domain=ah.10086.cn ;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"copq","text":"                #  path=/; HttpOnly\";","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"dkqfj","text":"        }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9k7qd","text":"","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9q86q","text":"","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"e3f04","text":"location /eGo{","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"31jhs","text":"                ssi on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7nim9","text":"                proxy_pass  http://wd_cluster/eGo;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"d8ot4","text":"                proxy_connect_timeout 60s;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a25rm","text":"                proxy_send_timeout 90;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8s5r4","text":"                proxy_read_timeout 120;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3bmf9","text":"                proxy_buffer_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5877k","text":"                proxy_buffers 4 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"672uk","text":"                proxy_busy_buffers_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7f1tv","text":"                proxy_temp_file_write_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5snd5","text":"                proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8i48h","text":"                proxy_max_temp_file_size 128m;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9lrht","text":"                proxy_redirect off;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3hhc3","text":"                proxy_set_header Host $host:$server_port;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2qets","text":"                proxy_set_header Cache-Control no-cache;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"dd64n","text":"                proxy_set_header X-Real-IP $remote_addr;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7bbn3","text":"               #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ffnm3","text":"               # add_header Set-Cookie \"ahwtapp=ahwtgray; domain=ah.10086.cn ;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"635vg","text":"                #  path=/; HttpOnly\";","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4kctb","text":"        }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cuvlh","text":"        location /newb2bpayment{","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9jmcn","text":"                ssi on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"26j39","text":"                proxy_pass  http://payment_cluster/newb2bpayment;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8oe4h","text":"                proxy_connect_timeout 60s;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5aoel","text":"                proxy_send_timeout 90;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"54fih","text":"                proxy_read_timeout 120;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2uajl","text":"                proxy_buffer_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"de478","text":"                proxy_buffers 4 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"634tf","text":"                proxy_busy_buffers_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"717sk","text":"                proxy_temp_file_write_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"deq7o","text":"                proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1025b","text":"                proxy_max_temp_file_size 128m;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6kqfh","text":"                proxy_redirect off;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5fr5q","text":"                proxy_set_header Host $host:$server_port;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"chp99","text":"                proxy_set_header Cache-Control no-cache;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fboft","text":"                proxy_set_header X-Real-IP $remote_addr;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3kp2q","text":"               #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"594nv","text":"               # add_header Set-Cookie \"ahwtapp=ahwtgray; domain=ah.10086.cn ;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8r4fm","text":"                #  path=/; HttpOnly\";","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6a079","text":"        }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3sgbv","text":"        location /newmarketplat{","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"16mqm","text":"                ssi on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a7kae","text":"                proxy_pass  http://wd_cluster/newmarketplat;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4hc83","text":"                proxy_connect_timeout 60s;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"etb25","text":"                proxy_send_timeout 90;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6h7fi","text":"                proxy_read_timeout 120;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5du4i","text":"                proxy_buffer_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8utl3","text":"                proxy_buffers 4 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"27lqk","text":"                proxy_busy_buffers_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c7g2p","text":"                proxy_temp_file_write_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"209bn","text":"                proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ppud","text":"                proxy_max_temp_file_size 128m;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"drm0c","text":"                proxy_redirect off;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"afgue","text":"                proxy_set_header Host $host:$server_port;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3j95o","text":"                proxy_set_header Cache-Control no-cache;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"92pba","text":"                proxy_set_header X-Real-IP $remote_addr;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3nt4","text":"               #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fuv86","text":"               # add_header Set-Cookie \"ahwtapp=ahwtgray; domain=ah.10086.cn ;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4suep","text":"                #  path=/; HttpOnly\";","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8lnq4","text":"        }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"93hkn","text":"        location /newmarketplatfront{","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2g463","text":"                ssi on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c5d7v","text":"                proxy_pass  http://wd_cluster/newmarketplatfront;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4oklo","text":"                proxy_connect_timeout 60s;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7blk9","text":"                proxy_send_timeout 90;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eeel7","text":"                proxy_read_timeout 120;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"df6dc","text":"                proxy_buffer_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"41deg","text":"                proxy_buffers 4 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8m86j","text":"                proxy_busy_buffers_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"atfsb","text":"                proxy_temp_file_write_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"dmmku","text":"                proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7u592","text":"                proxy_max_temp_file_size 128m;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ffia7","text":"                proxy_redirect off;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"qdfb","text":"                proxy_set_header Host $host:$server_port;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fm5ht","text":"                proxy_set_header Cache-Control no-cache;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"lbk7","text":"                proxy_set_header X-Real-IP $remote_addr;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"68o33","text":"               #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9kkc4","text":"               # add_header Set-Cookie \"ahwtapp=ahwtgray; domain=ah.10086.cn ;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"23bdb","text":"                #  path=/; HttpOnly\";","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"e6u5e","text":"        }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1r8pf","text":"location /mpad{","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3vlsf","text":"                ssi on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"j8ou","text":"                proxy_pass  http://wd_cluster/mpad;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"u7u0","text":"                proxy_connect_timeout 60s;#后端服务器连接的超时时间_发起握手等候响应超时时间","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5631g","text":"                proxy_send_timeout 90;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"edgjc","text":"                proxy_read_timeout 120;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"30t2e","text":"                proxy_buffer_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c33is","text":"                proxy_buffers 4 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eu49r","text":"                proxy_busy_buffers_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"smv8","text":"                proxy_temp_file_write_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8lvl0","text":"                proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"am0qv","text":"                proxy_max_temp_file_size 128m;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7iov","text":"                proxy_redirect off;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9nsfl","text":"                proxy_set_header Host $host:$server_port;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"35vnf","text":"                proxy_set_header Cache-Control no-cache;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ao85m","text":"                proxy_set_header X-Real-IP $remote_addr;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"42mst","text":"               #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fq16s","text":"               # add_header Set-Cookie \"ahwtapp=ahwtgray; domain=ah.10086.cn ;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1fath","text":"               #  path=/; HttpOnly\";","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a8b7s","text":"        }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ao9fk","text":"        #error_page  404              /404.html;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"89ch2","text":"        # redirect server error pages to the static page /50x.html","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2rp57","text":"        #","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bpjcp","text":"        error_page   500 502 503 504  /50x.html;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2a40i","text":"        location = /50x.html {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bajt5","text":"            root   html;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eiooe","text":"        }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4rgou","text":"        # proxy the PHP scripts to Apache listening on 127.0.0.1:80","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6s05l","text":"        #","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7s4fb","text":"        #location ~ \\.php$ {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6juf9","text":"        #    proxy_pass   http://127.0.0.1;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bfm0a","text":"        #}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6l8bv","text":"        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bcv05","text":"        #","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1et71","text":"        #location ~ \\.php$ {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6ucss","text":"        #    root           html;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"au3sa","text":"        #    fastcgi_pass   127.0.0.1:9000;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4fg8q","text":"        #    fastcgi_index  index.php;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c66ci","text":"        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c12r8","text":"        #    include        fastcgi_params;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7uabi","text":"        #}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"d03mq","text":"        # deny access to .htaccess files, if Apache's document root","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4p3fd","text":"        # concurs with nginx's one","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cigha","text":"        #","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"coejs","text":"        #location ~ /\\.ht {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"up9e","text":"        #    deny  all;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9k7dv","text":"        #}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8adbe","text":"    }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c8d9i","text":"    # another virtual host using mix of IP-, name-, and port-based configuration","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"97iml","text":"    #","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"813h8","text":"    #server {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4rrpr","text":"    #    listen       8000;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6osmf","text":"    #    listen       somename:8080;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"54h2v","text":"    #    server_name  somename  alias  another.alias;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"aqmin","text":"    #    location / {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4t2bb","text":"    #        root   html;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c5h16","text":"    #        index  index.html index.htm;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"96udg","text":"    #    }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7jof7","text":"    #}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"sknd","text":"    # HTTPS server","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"74bva","text":"    #","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6smst","text":"    #server {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bnkm4","text":"    #    listen       443;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bkiun","text":"    #    server_name  localhost;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2dtam","text":"    #    ssl                  on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6v0q0","text":"    #    ssl_certificate      cert.pem;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ft859","text":"    #    ssl_certificate_key  cert.key;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cib31","text":"    #    ssl_session_timeout  5m;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"418ch","text":"    #    ssl_protocols  SSLv2 SSLv3 TLSv1;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6iria","text":"    #    ssl_ciphers  HIGH:!aNULL:!MD5;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"dir0d","text":"    #    ssl_prefer_server_ciphers   on;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4p79m","text":"    #    location / {","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"718jt","text":"    #        root   html;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eucsi","text":"    #        index  index.html index.htm;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a2oiv","text":"    #    }","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a1vr9","text":"    #}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"d7gnq","text":"proxy_connect_timeout 90; #后端服务器连接的超时时间_发起握手等候响应超时时间","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"di7bj","text":"proxy_read_timeout 180;#连接成功后_等候后端服务器响应时间_其实已经进入后端的排队之中等候处理（也可以说是后端服务器处理请求的时间）","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9bja4","text":"proxy_send_timeout 180;#后端服务器数据回传时间_就是在规定时间之内后端服务器必须传完所有的数据","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3cvht","text":"proxy_buffer_size 256k;#设置从被代理服务器读取的第一部分应答的缓冲区大小，通常情况下这部分应答中包含一个小的应答头，默认情况下这个值的大小为指令proxy_buffers中指定的一个缓冲区的大小，不过可以将其设置为更小","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ehh40","text":"proxy_buffers 4 256k;#设置用于读取应答（来自被代理服务器）的缓冲区数目和大小，默认情况也为分页大小，根据操作系统的不同可能是4k或者8k","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"f0k5s","text":"proxy_busy_buffers_size 256k;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"dc029","text":"proxy_temp_file_write_size 256k;#设置在写入proxy_temp_path时数据的大小，预防一个工作进程在传递文件时阻塞太长","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5bl4n","text":"proxy_temp_path /data0/proxy_temp_dir;#proxy_temp_path和proxy_cache_path指定的路径必须在同一分区","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"88j88","text":"proxy_cache_path /data0/proxy_cache_dir levels=1:2 keys_zone=cache_one:200m inactive=1d max_size=30g;","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"abjvt","text":"#设置内存缓存空间大小为200MB，1天没有被访问的内容自动清除，硬盘缓存空间大小为30GB.","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"er0a5","text":"}","type":"custom-code-block-nginx","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}}]},"dateCreated":"2017-12-20T07:32:46.530Z","lastUpdated":"2017-12-20T09:29:38.619Z","notebookId":"B14EYgFgM"}
